angular.module("tcLib",["camera","ngDialog","ui.bootstrap"]),angular.module("tcLib").provider("httpService",function(){var c="";try{c=location.href.split("/")[3]}catch(e){c=""}this.setBasePath=function(e){c=e},this.$get=["$http","$q","$parse","msgService",function(n,a,i,o){return{get:r.bind(null,"GET"),del:r.bind(null,"DELETE"),put:e.bind(null,"PUT"),post:e.bind(null,"POST"),upload:function(e,t,n,a,i){return s({url:t=l(t,a,i),method:e,data:n,transformRequest:angular.identity,headers:{"Content-Type":void 0}})}.bind(null,"POST"),getJSON:function(e,t,n){return n&&localStorage.getItem(n)?a.when(null).then(function(){var e=localStorage.getItem(n);return JSON.parse(e)}):r(e,t).then(function(e){return localStorage.setItem(n,e.json),e})}.bind(null,"GET")};function r(e,t,n,a){return s({method:e,url:t=l(t,n,a)})}function e(e,t,n,a,i){return s({method:e,url:t=l(t,a,i),data:n})}function l(e,t,n){return t&&(e+="?"+toURLParams(t,n)),"/"+c+"/"+e}function s(e){var t=a.defer();return n(e).success(function(e){e.isSuccess?t.resolve(e.response):(t.reject(e),o.showMsg({msg:i("response")(e)||e,type:"danger",title:"Error"}))}).error(function(e){t.reject(e),o.showMsg({msg:e,type:"danger",title:"Error"})}),t.promise}}]}),angular.module("tcLib").directive("bindHtmlCompile",["$compile",function(a){return{restrict:"A",link:function(t,n,e){t.$watch(function(){return t.$eval(e.bindHtmlCompile)},function(e){n.html(e),a(n.contents())(t)})}}}]),angular.module("tcLib").directive("tcCamera",["ngDialog",function(i){return{restrict:"A",require:"ngModel",scope:{onCapture:"&",confirmText:"@"},link:function(t,e,n,a){angular.element(e).bind("click",function(){t.capturePhoto()}),t.autoClose=!t.confirmText,t.setModel=function(e){t.tempModel=e},t.setConfirmed=function(e){t.confirmed=e},t.capturePhoto=function(){i.open({template:"src/scripts/camera/camera-modal.html",className:"ngdialog-theme-default ngdialog-lg",controller:"cameraModelCtrl",closeByDocument:!1,scope:t}).closePromise.then(function(){"function"==typeof t.onCapture&&(t.confirmed&&a.$setViewValue(t.tempModel),t.onCapture({$snap:t.tempModel}))})}}}}]),angular.module("tcLib").controller("cameraModelCtrl",["$scope","ngDialog",function(t,e){t.onCamCapture=function(e){t.setModel(e),t.autoClose&&t.confirm()},t.confirm=function(){t.setConfirmed(!0)},t.cancel=function(){t.setConfirmed(!1)}}]),angular.module("tcLib").directive("clickAndDisable",[function(){return{restrict:"A",scope:{clickAndDisable:"&"},link:function(e,t,n){t.bind("click",function(){e.clickAndDisable=e.clickAndDisable||$timeout(angular.noop,5e3),t.prop("disabled",!0),e.clickAndDisable().finally(function(){t.prop("disabled",!1)})})}}}]),angular.module("tcLib").directive("tcDatePicker",["$parse",function(o){return{restrict:"E",scope:{name:"@",options:"=?",disabled:"=?",placeholder:"@",model:"=ngModel"},templateUrl:function(e,t){var n="src/scripts/date-picker/date-picker.html";return t.hasOwnProperty("datetime")&&(n="src/scripts/date-picker/date-time-picker.html"),n},link:function(i,e,t){function n(e){var t=e.date;if("day"===e.mode)for(var n=new Date(t).setHours(0,0,0,0),a=0;a<(o("events.length")(i)||0);a++){if(n===new Date($scope.events[a].date).setHours(0,0,0,0))return $scope.events[a].status}return""}i.calendarPanel={opened:!1},i.openCalendar=function(){i.calendarPanel.opened=!0},i.$watch("options",function(e,t){i.dateOptions={formatYear:"yy",showWeeks:!1,customClass:n,minDate:o("options.minDate")(i)||null,maxDate:o("options.maxDate")(i)||new Date(2040,12,31),startingDay:1}})}}}]),angular.module("tcLib").constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},initialPicker:"date",reOpenDefault:!1,enableDate:!0,enableTime:!0,buttonBar:{show:!0,now:{show:!0,text:"Now"},today:{show:!0,text:"Today"},clear:{show:!0,text:"Clear"},date:{show:!0,text:"Date"},time:{show:!0,text:"Time"},close:{show:!0,text:"Close"}},closeOnDateSelection:!0,appendToBody:!1,altInputFormats:[],ngModelOptions:{}}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function(r,l,s,c,d,u,n,a,p,m,g,e){var f,b,h,w=g.dateFormat,i={},D=[],o=angular.isDefined(s.closeOnDateSelection)?r.$parent.$eval(s.closeOnDateSelection):g.closeOnDateSelection,k=angular.isDefined(s.datepickerAppendToBody)?r.$parent.$eval(s.datepickerAppendToBody):g.appendToBody,v=angular.isDefined(s.altInputFormats)?r.$parent.$eval(s.altInputFormats):g.altInputFormats;function y(e){var t=h[0],n=l[0].contains(e.target),a=void 0!==t.contains&&t.contains(e.target);!r.isOpen||n||a||r.$apply(function(){r.close(!1)})}function $(e){27===e.which&&r.isOpen?(e.preventDefault(),e.stopPropagation(),r.$apply(function(){r.close(!1)}),l[0].focus()):40!==e.which||r.isOpen||(e.preventDefault(),e.stopPropagation(),r.$apply(function(){r.isOpen=!0}))}function S(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function M(e){var t=m.parse(e,w,r.date);if(isNaN(t))for(var n=0;n<v.length;n++)if(t=m.parse(e,v[n],r.date),!isNaN(t))return t;return t}function T(e){if(angular.isNumber(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=M(e);return isNaN(t)?void 0:m.toTimezone(t,b.timezone)}}function P(e,t){var n=e||t;return!(s.ngRequired||s.required||n)||(angular.isNumber(n)&&(n=new Date(n)),!n||(!(!angular.isDate(n)||isNaN(n))||(!(!angular.isDate(new Date(n))||isNaN(new Date(n).valueOf()))||!!angular.isString(n)&&!isNaN(M(t)))))}this.init=function(e){if(b=(f=e).$options||g.ngModelOptions,r.watchData={},r.buttonBar=angular.isDefined(s.buttonBar)?r.$parent.$eval(s.buttonBar):g.buttonBar,r.enableDate=angular.isDefined(r.enableDate)?r.enableDate:g.enableDate,r.enableTime=angular.isDefined(r.enableTime)?r.enableTime:g.enableTime,r.initialPicker=angular.isDefined(s.initialPicker)?s.initialPicker:r.enableDate?g.initialPicker:"time",r.reOpenDefault=angular.isDefined(s.reOpenDefault)?s.reOpenDefault:g.reOpenDefault,"date"==r.initialPicker&&!r.enableDate)throw new Error("datetimePicker can't have initialPicker set to date and have enableDate set to false.");r.showPicker=r.enableDate?r.initialPicker:"time";var t=!1;g.html5Types[s.type]?(w=g.html5Types[s.type],t=!0):(w=s.datepickerPopup||g.dateFormat,s.$observe("datetimePicker",function(e){var t=e||g.dateFormat;if(t!==w&&(w=t,f.$modelValue=null,!w))throw new Error("datetimePicker must have a date format specified.")}));var n=angular.element('<div class=uib-datetimepicker-popup-wrap><div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div></div>');r.ngModelOptions=angular.copy(b),r.ngModelOptions.timezone=null,n.attr({"ng-model":"date","ng-model-options":"ngModelOptions","ng-change":"dateSelection(date)"});var a=angular.element(n.children()[0]);(t&&"month"===s.type&&(a.attr("datepicker-mode",'"month"'),a.attr("min-mode","month")),s.datepickerOptions)&&((o=r.$parent.$eval(s.datepickerOptions))&&o.initDate&&(r.initDate=m.fromTimezone(o.initDate,b.timezone),a.attr("init-date","initDate"),delete o.initDate),angular.forEach(o,function(e,t){a.attr(S(t),e)}));angular.isDefined(s.datepickerMode)||(s.datepickerMode="day"),s.dateDisabled&&a.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","showWeeks","startingDay","yearRows","yearColumns"],function(e){angular.isDefined(s[e])&&a.attr(S(e),s[e])}),s.customClass&&a.attr("custom-class","customClass({ date: date, mode: mode })"),angular.forEach(["minMode","maxMode","datepickerMode","shortcutPropagation"],function(t){if(s[t]){var e=d(s[t]);if(D.push(r.$parent.$watch(e,function(e){r.watchData[t]=e})),a.attr(S(t),"watchData."+t),"datepickerMode"===t){var n=e.assign;D.push(r.$watch("watchData."+t,function(e,t){angular.isFunction(n)&&e!==t&&n(r.$parent,e)}))}}});var i=angular.element(n.children()[1]);if(s.timepickerOptions){var o=r.$parent.$eval(s.timepickerOptions);angular.forEach(o,function(e,t){r.watchData[t]=e,i.attr(S(t),"watchData."+t)})}angular.forEach(["minDate","maxDate","initDate"],function(t){if(s[t]){var e=d(s[t]);D.push(r.$parent.$watch(e,function(e){r.watchData[t]=e})),a.attr(S(t),"watchData."+t),"minDate"==t?i.attr("min","watchData.minDate"):"maxDate"==t&&i.attr("max","watchData.maxDate")}}),t?f.$formatters.push(function(e){return r.date=m.fromTimezone(e,b.timezone),e}):(f.$$parserName="datetime",f.$validators.datetime=P,f.$parsers.unshift(T),f.$formatters.push(function(e){return f.$isEmpty(e)?r.date=e:(r.date=m.fromTimezone(e,b.timezone),w=w.replace(/M!/,"MM").replace(/d!/,"dd"),p(r.date,w))})),f.$viewChangeListeners.push(function(){r.date=M(f.$viewValue)}),l.bind("keydown",$),h=c(n)(r),n.remove(),k?u.find("body").append(h):l.after(h)},r.getText=function(e){return r.buttonBar[e].text||g.buttonBar[e].text},r.doShow=function(e){return angular.isDefined(r.buttonBar[e].show)?r.buttonBar[e].show:g.buttonBar[e].show},r.dateSelection=function(e){r.enableTime&&"time"===r.showPicker&&((e||null!=e)&&(angular.isDefined(r.date)&&null!=r.date||(r.date=new Date),e&&null!=e&&((a=new Date(r.date)).setHours(e.getHours()),a.setMinutes(e.getMinutes()),a.setSeconds(e.getSeconds()),a.setMilliseconds(e.getMilliseconds()),e=a)));if(angular.isDefined(e)){if(!r.date){var t=angular.isDefined(s.defaultTime)?s.defaultTime:g.defaultTime,n=new Date("2001-01-01 "+t);isNaN(n)||null==e||(e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(n.getSeconds()),e.setMilliseconds(n.getMilliseconds()))}r.date=e}var a=r.date?p(r.date,w,b.timezone):null;l.val(a),f.$setViewValue(a),o&&"time"!=r.showPicker&&null!=a&&(r.enableTime?r.open("time"):r.close(!1))},r.keydown=function(e){27===e.which&&(r.close(!1),l[0].focus())},r.$watch("isOpen",function(e){if(r.dropdownStyle={display:e?"block":"none"},e){i.openDate=r.date;var t=k?a.offset(l):a.position(l);r.dropdownStyle.top=k?t.top+l.prop("offsetHeight")+"px":void 0,r.dropdownStyle.left=t.left+"px",n(function(){r.$broadcast("uib:datepicker.focus"),u.bind("click",y)},0,!1),r.open(r.showPicker)}else u.unbind("click",y)}),r.isDisabled=function(e){return"today"!==e&&"now"!==e||(e=new Date),r.watchData.minDate&&r.compare(e,r.watchData.minDate)<0||r.watchData.maxDate&&0<r.compare(e,r.watchData.maxDate)},r.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},r.select=function(e){var t=null;if("today"===e||"now"==e){var n=new Date;angular.isDate(r.date)?((t=new Date(r.date)).setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())):t=n}r.dateSelection(t),"clear"==e&&r.close()},r.open=function(e,t){angular.isDefined(t)&&(t.preventDefault(),t.stopPropagation()),n(function(){r.showPicker=e},0),n(function(){r.date=new Date(r.date)},50)},r.close=function(e){r.isOpen=!1,r.enableDate&&r.enableTime&&(r.showPicker=!1===r.reOpenDefault?"date":r.reOpenDefault),angular.isDefined(e)&&r.whenClosed({args:{closePressed:e,openDate:i.openDate||null,closeDate:r.date}}),l[0].focus()},r.$on("$destroy",function(){!0===r.isOpen&&(e.$$phase||r.$apply(function(){r.close()})),D.forEach(function(e){e()}),h.remove(),l.unbind("keydown",$),u.unbind("click",y)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",initialPicker:"=?",reOpenDefault:"=?",dateDisabled:"&",customClass:"&",whenClosed:"&"},link:function(e,t,n,a){var i=a[0];a[1].init(i)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"src/scripts/date-time-picker/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"src/scripts/date-time-picker/time-picker.html"}}),angular.module("tcLib").directive("tcFileInput",[function(){return{restrict:"AE",require:"ngModel",scope:{ngModel:"="},link:function(e,n,a,i){n.on("change",function(e){var t=n[0].files;i.$setViewValue(null),a.multiple?i.$setViewValue(t.length?t:null):i.$setViewValue(t[0])})}}}]),angular.module("tcLib").directive("messages",function(){function e(a){function i(e){a.globalMsgs.splice(e,1)}a.globalMsgs=[],a.remove=i,a.$on("MESSAGE_SHOW",function(e,t){a.globalMsgs.splice(0,0,t)}),a.$on("MESSAGE_HIDE",function(e,t){var n=a.globalMsgs.indexOf(t);-1!=n&&i(n)}),a.$on("MESSAGE_HIDE_ALL",function(e){a.globalMsgs=[]})}return e.$inject=["$scope"],{restrict:"E",controller:e,templateUrl:"src/scripts/messages/message.html"}}).service("msgService",["$timeout","$rootScope","$parse",function(t,n,a){return{showMsg:function(e){n.$broadcast("MESSAGE_SHOW",e),document.querySelector(".message-wrapper").scrollTop=0,"danger"!==a("type")(e)&&t(function(){n.$broadcast("MESSAGE_HIDE",e)},a("time")(e)||2e3)},hideAll:function(){n.$broadCast("MESSAGE_HIDE_ALL")}}}]),angular.module("tcLib").filter("tcCamelCase",function(){return function(e){return(e=e||"").replace(/\w\S*/g,function(e){for(var t=e.charAt(0).toUpperCase()+e.substr(1).toLowerCase(),n=0;n<t.length;n++)"."===t[n]&&(t=t.replace(t.charAt(n+1),function(e){return e.toUpperCase()}));return t})}}),angular.module("tcLib").directive("whenScrolled",function(){return{restrict:"A",scope:{scrollerApi:"=?",whenScrolled:"&"},link:function(e,t,n){var a=0;raw=t[0],t.bind("scroll",function(){a<raw.scrollTop&&raw.scrollTop+raw.offsetHeight>=raw.scrollHeight&&(e.whenScrolled(),a=raw.scrollTop)}),e.scrollerApi={resetScroll:function(){a=0,raw.scrollTop=0}}}}}),angular.module("tcLib").run(["$templateCache",function(e){e.put("src/scripts/camera/camera-modal.html",'<div class="camera-wrapper row"><ng-camera capture-message="Done!" class="grid-md-5" countdown="3" output-height="240" output-width="320" viewer-height="315" viewer-width="420" image-format="jpeg" jpeg-quality="100" action-message="Take picture" snapshot="model" overlay-url="./assets/images/overlay.png" shutter-url="./assets/sounds/camera-click.mp3" on-capture="onCamCapture($snap)"></ng-camera><div class="preview-wrapper grid-md-5" ng-if="model"><img ng-src="{{model}}" alt="Click capture to see preview"><div class="grid-md-4 ngdialog-buttons"><button class="btn btn-md btn-green" ng-if="confirmText && model" ng-click="confirm();closeThisDialog(0)">{{confirmText}}</button> <button class="btn btn-md btn-grey" ng-if="confirmText" ng-click="cancel();closeThisDialog(0);">Cancel</button></div></div></div>'),e.put("src/scripts/date-picker/date-picker.html",'<input placeholder="{{placeholder}}" class="form-field grid-md-12" ng-attr-name="{{name}}" ng-model="model" uib-datepicker-popup is-open="calendarPanel.opened" datepicker-options="dateOptions" ng-disabled="disabled" ng-required="{{required}}" close-text="Close"> <span class="form-field-icon" ng-if="!disabled"><button type="button" class="btn btn-sm btn-sky-blue" ng-click="openCalendar()"><i class="fa fa-calendar"></i></button></span>'),e.put("src/scripts/date-picker/date-time-picker.html",'<input placeholder="{{placeholder}}" class="form-field grid-md-12" ng-attr-name="{{name}}" ng-model="model" datetime-picker="dd-MM-yyyy hh:mm a" is-open="calendarPanel.opened" datepicker-options="dateOptions" ng-disabled="disabled" ng-required="{{required}}" close-text="Close"> <span class="form-field-icon" ng-if="!disabled"><button type="button" class="btn btn-sm btn-sky-blue" ng-click="openCalendar()"><i class="fa fa-calendar"></i></button></span>'),e.put("src/scripts/date-time-picker/date-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'date\'" ng-style="dropdownStyle" style="left:inherit" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()"><li class="date-picker-menu"><div ng-transclude></div></li><li class="row" style="margin-top: 5px" ng-if="buttonBar.show"><span class="btn-group pull-left" style="margin-right:10px" ng-if="doShow(\'today\') || doShow(\'clear\')"><button type="button" class="btn btn-sm btn-info" ng-if="doShow(\'today\')" ng-click="select(\'today\')" ng-disabled="isDisabled(\'today\')">{{getText(\'today\')}}</button> <button type="button" class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\')">{{getText(\'clear\')}}</button> </span><span class="btn-group pull-right" ng-if="(doShow(\'time\') && enableTime) || doShow(\'close\')"><button type="button" class="btn btn-sm btn-default" ng-if="doShow(\'time\') && enableTime" ng-click="open(\'time\', $event)">{{getText(\'time\')}}</button> <button type="button" class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true)">{{getText(\'close\')}}</button></span></li></ul>'),e.put("src/scripts/date-time-picker/time-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'time\'" ng-style="dropdownStyle" style="left:inherit" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()"><li style="padding:0 5px 5px 5px" class="time-picker-menu"><div ng-transclude></div></li><li class="row" style="margin-top:5px" ng-if="buttonBar.show"><span class="btn-group pull-left" style="margin-right:10px" ng-if="doShow(\'now\') || doShow(\'clear\')"><button type="button" class="btn btn-sm btn-info" ng-if="doShow(\'now\')" ng-click="select(\'now\')" ng-disabled="isDisabled(\'now\')">{{getText(\'now\') }}</button> <button type="button" class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\')">{{ getText(\'clear\') }}</button> </span><span class="btn-group pull-right" ng-if="(doShow(\'date\') && enableDate) || doShow(\'close\')"><button type="button" class="btn btn-sm btn-default" ng-if="doShow(\'date\') && enableDate" ng-click="open(\'date\', $event)">{{ getText(\'date\')}}</button> <button type="button" class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true)">{{getText(\'close\')}}</button></span></li></ul>'),e.put("src/scripts/messages/message.html",'<div class="message-wrapper"><div ng-repeat="msg in globalMsgs" class="alert alert-{{msg.type}}"><i class="fa fa-times pull-right" ng-click="remove($index)"></i> <strong>{{msg.title}}:</strong> <span>{{msg.msg}}</span></div></div>')}]);